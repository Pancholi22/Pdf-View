<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Base64 to File Viewer</title>
</head>
<body>
    <h2>Base64 File Viewer</h2>
    <iframe id="fileFrame" width="100%" height="500px"></iframe>
    <br>
    <a id="downloadLink" style="display: none;" download="decoded_file">Download File</a>

    <script>
        function getQueryParam(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        function base64ToBlob(base64, contentType = '') {
            const byteCharacters = atob(base64);
            const byteArrays = [];

            for (let offset = 0; offset < byteCharacters.length; offset += 512) {
                const slice = byteCharacters.slice(offset, offset + 512);
                const byteNumbers = new Array(slice.length);
                for (let i = 0; i < slice.length; i++) {
                    byteNumbers[i] = slice.charCodeAt(i);
                }
                byteArrays.push(new Uint8Array(byteNumbers));
            }

            return new Blob(byteArrays, { type: contentType });
        }

        const base64String = getQueryParam('base64');

        if (base64String) {
            const contentType = "application/pdf"; // Change this for different file types
            const blob = base64ToBlob(base64String, contentType);
            const blobUrl = URL.createObjectURL(blob);

            // Show in iframe if it's a PDF or image
            const fileFrame = document.getElementById('fileFrame');
            fileFrame.src = blobUrl;

            // Set up download link
            const downloadLink = document.getElementById('downloadLink');
            downloadLink.href = blobUrl;
            downloadLink.style.display = "block";
        } else {
            alert("No base64 string provided in the URL.");
        }
    </script>
</body>
</html>
